<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Notes</title>
  </head>
  <body>
    <h1>Welcome <%= user.name %>!</h1>
    <form method="POST" action="/notes">
      <div>
        <label for="note">New note:</label>
        <input type="text" id="note" name="note" required />
      </div>
      <div>
        <button type="submit">Save note</button>
      </div>
    </form>
    <p>Your notes:</p>
    <ul id="notes"></ul>
    <a href="/logout">Logout</a>

    <script>
      // 로컬스토리지에 저장된 메모를 불러와서 표시합니다.
      var notes = JSON.parse(localStorage.getItem("notes")) || [];
      var notesList = document.getElementById("notes");
      notes.forEach(function (note) {
        var li = document.createElement("li");
        li.textContent = note;
        notesList.appendChild(li);
      });
      // 폼을 제출할 때마다 새로운 메모를 로컬스토리지에 추가합니다.
      var form = document.querySelector("form");
      form.addEventListener("submit", function (event) {
        event.preventDefault();
        var noteInput = document.getElementById("note");
        var note = noteInput.value;
        notes.push(note);
        localStorage.setItem("notes", JSON.stringify(notes));
        var li = document.createElement("li");
        li.textContent = note;
        notesList.appendChild(li);
        noteInput.value = "";
      });
    </script>
  </body>
</html>
